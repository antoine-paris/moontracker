/* Mobile-specific adaptations for SpaceView */

/* Base mobile layout classes */
.mobile-layout.is-mobile.is-portrait {
  --mobile-portrait: true;
}

.mobile-layout.is-mobile.is-landscape {
  --mobile-landscape: true;
}

/* Mobile fullscreen SpaceView */
.mobile-layout.is-mobile .spaceview-container {
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1;
}

/* Cache complètement la sidebar desktop sur mobile */
.mobile-layout.is-mobile aside.sidebar-mobile,
.mobile-layout.is-mobile .sidebar-mobile,
.mobile-layout.is-mobile aside[style*="z-index"],
.mobile-layout.is-mobile aside.shrink-0 {
  display: none !important;
  width: 0 !important;
  min-width: 0 !important;
  max-width: 0 !important;
  flex: none !important;
  flex-basis: 0 !important;
  flex-shrink: 0 !important;
  flex-grow: 0 !important;
  overflow: hidden !important;
  margin: 0 !important;
  padding: 0 !important;
  position: absolute !important;
  left: -9999px !important;
}

/* Layout flex adapté pour mobile */
.mobile-layout.is-mobile .flex.h-full {
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100vw;
  height: 100vh;
}

/* Force la sidebar à disparaître dans le contexte flex */
.mobile-layout.is-mobile .flex.h-full > aside:first-child {
  display: none !important;
  width: 0 !important;
  flex: none !important;
}

/* Stage plein écran sur mobile */
.mobile-layout.is-mobile main {
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100vw !important;
  height: 100vh !important;
  flex: none !important;
}

/* Contenu SpaceView plein écran */
.mobile-layout.is-mobile .stage {
  width: 100vw !important;
  height: 100vh !important;
  position: fixed !important;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

/* Cache certains éléments sur mobile */
.mobile-layout.is-mobile .hide-on-mobile {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
  flex: none !important;
  flex-basis: 0 !important;
}

.mobile-layout.is-mobile.is-portrait .hide-on-mobile-portrait {
  display: none !important;
}

/* Réduit la taille des contrôles sur mobile */
.mobile-layout.is-mobile .mobile-compact {
  transform: scale(0.9);
  transform-origin: center;
}

/* Gestures tactiles optimisées */
.mobile-layout.is-mobile {
  touch-action: manipulation;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Boutons tactiles plus grands */
.mobile-layout.is-mobile button,
.mobile-layout.is-mobile [role="button"] {
  min-height: 44px;
  min-width: 44px;
}

/* Sidebar adaptée mobile */
.mobile-layout.is-mobile.is-portrait .sidebar {
  width: 100%;
  height: 40vh;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  transform: translateY(100%);
  transition: transform 0.3s ease-in-out;
}

.mobile-layout.is-mobile.is-portrait .sidebar.open {
  transform: translateY(0);
}

/* Panneaux de contrôle empilés en portrait */
.mobile-layout.is-mobile.is-portrait .control-panels {
  flex-direction: column;
  gap: 8px;
}

.mobile-layout.is-mobile.is-portrait .control-panel {
  max-height: 50vh;
  overflow-y: auto;
}

/* Directional keypad horizontal en bas pour mobile */
.mobile-layout.is-mobile .directional-keypad {
  position: fixed !important;
  bottom: 10px;
  left: 50%;
  right: auto;
  transform: translateX(-50%);
  z-index: 100;
  background: rgba(0, 0, 0, 0.7);
  border-radius: 20px;
  padding: 8px 16px;
  backdrop-filter: blur(10px);
}

.mobile-layout.is-mobile .directional-keypad .keypad-grid {
  display: flex !important;
  flex-direction: row !important;
  gap: 8px;
  align-items: center;
}

.mobile-layout.is-mobile .directional-keypad button {
  min-width: 44px;
  min-height: 44px;
  border-radius: 8px;
}

/* TopBar compacte sur mobile */
.mobile-layout.is-mobile.is-portrait .topbar {
  padding: 8px;
  flex-wrap: wrap;
  gap: 4px;
}

.mobile-layout.is-mobile.is-portrait .topbar > * {
  flex: 1 1 45%;
  min-width: 120px;
}

/* Télémétrie bottom compacte */
.mobile-layout.is-mobile.is-portrait .bottom-telemetry {
  flex-direction: column;
  gap: 8px;
  max-height: 30vh;
}

/* Stage/viewport adaptatif */
.mobile-layout.is-mobile.is-portrait .stage {
  height: calc(100vh - 200px); /* Espace pour les contrôles */
}

.mobile-layout.is-mobile.is-landscape .stage {
  height: 100vh;
}

/* Masque l'overlay d'info en portrait mobile si trop petit */
@media (max-height: 600px) and (orientation: portrait) {
  .mobile-layout.is-mobile .info-overlay {
    display: none;
  }
}

/* TopRightBar optimisée pour mobile */
.mobile-layout.is-mobile .absolute.top-2.right-2 {
  top: env(safe-area-inset-top, 8px) !important;
  right: env(safe-area-inset-right, 8px) !important;
}

.mobile-layout.is-mobile .absolute.top-2.right-2[style*="marginTop"] {
  margin-top: 0 !important;
}

/* Gestion du notch et safe areas */
.mobile-layout.is-mobile {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* Performance mobile - réduit les animations complexes */
@media (max-width: 768px) {
  .complex-animation {
    animation: none !important;
  }
  
  .blur-effect {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
}

/* Scroll bars cachées sur mobile */
.mobile-layout.is-mobile ::-webkit-scrollbar {
  display: none;
}

.mobile-layout.is-mobile {
  -ms-overflow-style: none;
  scrollbar-width: none;
}